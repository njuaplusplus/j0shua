{% extends "hymns/base.html" %}
{% load staticfiles %}

{% block title%}乐谱 | 约书亚团契{% endblock %}

{% block headBlock %}
{% if hymn.hymn_audio %}
    <link type="text/css" href=" {% static 'jplayer/jplayer.blue.monday.css' %}" rel="stylesheet" />
{% endif %}
{% endblock %}

{% block hymnsMainContent %}
<div class="row">
    <div class="col-md-12 text-center">
        {% if hymn %}
            <h1>{{ hymn.hymn_index }} | {{ hymn.hymn_name }}</h1>
        {% endif %}
        <div class="btn-group btn-group-justified">
            {% if hymn.hymn_ppt %}
            <a class="btn btn-default" href="{{ hymn.hymn_ppt.url }}" role="button"><span class="glyphicon glyphicon-save"></span> 下载 PPT </a>
            {% endif %}
            {% if hymn.hymn_pdf %}
            <a class="btn btn-default" href="{{ hymn.hymn_pdf.url }}" role="button"><span class="glyphicon glyphicon-save"></span> 下载 PDF </a>
            {% endif %}
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12 text-center">
        {% if hymn.hymn_score %}
            <img src="{{ hymn.hymn_score.url }}" style="max-width: 100%; height: auto;" alt="{{ hymn.hymn_name }}">
        {% else %}
            <h2>No scores......</h2>
        {% endif %}
    </div>
</div>
{% if hymn.hymn_audio %}
<div class="row">
    <div class="col-md-6 col-md-offset-3 col-xs-12 col-xs-offset-0">
        <div id="jquery_jplayer_1" class="jp-jplayer"></div>
        <div id="jp_container_1" class="jp-audio">
            <div class="jp-type-single">
                <div class="jp-gui jp-interface">
                    <ul class="jp-controls">
                        <li><a href="javascript:;" class="jp-play" tabindex="1">play</a></li>
                        <li><a href="javascript:;" class="jp-pause" tabindex="1">pause</a></li>
                        <li><a href="javascript:;" class="jp-stop" tabindex="1">stop</a></li>
                        <li><a href="javascript:;" class="jp-mute" tabindex="1" title="mute">mute</a></li>
                        <li><a href="javascript:;" class="jp-unmute" tabindex="1" title="unmute">unmute</a></li>
                        <li><a href="javascript:;" class="jp-volume-max" tabindex="1" title="max volume">max volume</a></li>
                    </ul>
                    <div class="jp-progress">
                        <div class="jp-seek-bar">
                            <div class="jp-play-bar"></div>
                        </div>
                    </div>
                    <div class="jp-volume-bar">
                        <div class="jp-volume-bar-value"></div>
                    </div>
                    <div class="jp-time-holder">
                        <div class="jp-current-time"></div>
                        <div class="jp-duration"></div>
                        <ul class="jp-toggles">
                            <li><a href="javascript:;" class="jp-repeat" tabindex="1" title="repeat">repeat</a></li>
                            <li><a href="javascript:;" class="jp-repeat-off" tabindex="1" title="repeat off">repeat off</a></li>
                        </ul>
                    </div>
                </div>
                <div class="jp-details">
                    <ul>
                        <li><span class="jp-title">Bubble</span</li>
                    </ul>
                </div>
                <div class="jp-no-solution">
                    <span>Update Required</span>
                    To play the media you will need to either update your browser to a recent version or update your <a href="http://get.adobe.com/flashplayer/" target="_blank">Flash plugin</a>.
                </div>
            </div>
        </div>
    </div>
</div>
{% else %}
<div class="row">
    <div class="col-md-6 col-md-offset-3 col-xs-12 col-xs-offset-0">
        <form role="form" method="POST" action="{% url 'hymns:saveAudioFile' hymn.id %}">
            {% csrf_token %}
            <div class="form-group">
                <label for="audioUrlInput">歌曲链接(来自<a href="http://www.zanmeishi.com/" target="_blank">赞美诗网</a>)</label>
                <input type="text" class="form-control" name="audioUrlInput" id="audioUrlInput" placeholder="如 http://www.zanmeishi.com/song/8445.html">
            </div>
            <button type="submit" class="btn btn-primary">上传</button>
        </form>
    </div>
</div>
{% endif %}
{% endblock %}

{% block extScriptFile %}
{% if hymn.hymn_audio %}
    <script type="text/javascript" src="{% static 'jplayer/jquery.jplayer.min.js' %}"></script>
{% endif %}
{% endblock %}

{% block extScript %}
{% if hymn.hymn_audio %}
    $("#jquery_jplayer_1").jPlayer({
        ready: function () {
            $(this).jPlayer("setMedia", {
                title: "{{ hymn.hymn_name }}",
                mp3: "{{ hymn.hymn_audio }}",
            });
        },
        swfPath: "{% static 'jplayer/' %}",
        supplied: "mp3"
    });
{% endif %}
{% endblock %}
